n_most_common_words = 2500
max_len = 50
model = Sequential()
model.add(Embedding(len(word_index)+1, max_len))
model.add(LSTM(max_len))
model.add(Dense(dense_num, activation='softmax'))

es = EarlyStopping(monitor='val_loss', mode='min', verbose=1, patience=4)
mc = ModelCheckpoint('best_model.h5', monitor='val_acc', mode='max', verbose=1, save_best_only=True)

model.compile(loss='categorical_crossentropy', optimizer='adam', metrics=['acc'])
history = model.fit(X_train, y_train_one, batch_size=128, epochs=30, callbacks=[es, mc], validation_data=(X_test, y_test_one))







  128/23646 [..............................] - ETA: 18s - loss: 0.3809 - acc: 0.9062
  256/23646 [..............................] - ETA: 16s - loss: 0.3144 - acc: 0.9258
  384/23646 [..............................] - ETA: 16s - loss: 0.3678 - acc: 0.9141
  512/23646 [..............................] - ETA: 16s - loss: 0.3652 - acc: 0.9219
  640/23646 [..............................] - ETA: 16s - loss: 0.3814 - acc: 0.9141
  768/23646 [..............................] - ETA: 16s - loss: 0.3665 - acc: 0.9180
  896/23646 [>.............................] - ETA: 15s - loss: 0.3686 - acc: 0.9163
 1024/23646 [>.............................] - ETA: 15s - loss: 0.3752 - acc: 0.9131
 1152/23646 [>.............................] - ETA: 15s - loss: 0.3845 - acc: 0.9080
 1280/23646 [>.............................] - ETA: 15s - loss: 0.3788 - acc: 0.9094
 1408/23646 [>.............................] - ETA: 15s - loss: 0.3831 - acc: 0.9084
 1536/23646 [>.............................] - ETA: 15s - loss: 0.3820 - acc: 0.9102
 1664/23646 [=>............................] - ETA: 14s - loss: 0.3721 - acc: 0.9135
 1792/23646 [=>............................] - ETA: 14s - loss: 0.3705 - acc: 0.9152
 1920/23646 [=>............................] - ETA: 14s - loss: 0.3636 - acc: 0.9187
 2048/23646 [=>............................] - ETA: 14s - loss: 0.3587 - acc: 0.9194
 2176/23646 [=>............................] - ETA: 14s - loss: 0.3594 - acc: 0.9191
 2304/23646 [=>............................] - ETA: 14s - loss: 0.3637 - acc: 0.9184
 2432/23646 [==>...........................] - ETA: 14s - loss: 0.3697 - acc: 0.9157
 2560/23646 [==>...........................] - ETA: 14s - loss: 0.3750 - acc: 0.9160
 2688/23646 [==>...........................] - ETA: 14s - loss: 0.3768 - acc: 0.9144
 2816/23646 [==>...........................] - ETA: 13s - loss: 0.3809 - acc: 0.9144
 2944/23646 [==>...........................] - ETA: 13s - loss: 0.3817 - acc: 0.9141
 3072/23646 [==>...........................] - ETA: 13s - loss: 0.3868 - acc: 0.9124
 3200/23646 [===>..........................] - ETA: 13s - loss: 0.3826 - acc: 0.9137
 3328/23646 [===>..........................] - ETA: 13s - loss: 0.3803 - acc: 0.9141
 3456/23646 [===>..........................] - ETA: 13s - loss: 0.3781 - acc: 0.9144
 3584/23646 [===>..........................] - ETA: 13s - loss: 0.3760 - acc: 0.9152
 3712/23646 [===>..........................] - ETA: 13s - loss: 0.3754 - acc: 0.9151
 3840/23646 [===>..........................] - ETA: 13s - loss: 0.3754 - acc: 0.9146
 3968/23646 [====>.........................] - ETA: 13s - loss: 0.3792 - acc: 0.9151
 4096/23646 [====>.........................] - ETA: 13s - loss: 0.3766 - acc: 0.9155
 4224/23646 [====>.........................] - ETA: 12s - loss: 0.3759 - acc: 0.9157
 4352/23646 [====>.........................] - ETA: 12s - loss: 0.3758 - acc: 0.9157
 4480/23646 [====>.........................] - ETA: 12s - loss: 0.3746 - acc: 0.9163
 4608/23646 [====>.........................] - ETA: 12s - loss: 0.3729 - acc: 0.9167
 4736/23646 [=====>........................] - ETA: 12s - loss: 0.3759 - acc: 0.9162
 4864/23646 [=====>........................] - ETA: 12s - loss: 0.3746 - acc: 0.9163
 4992/23646 [=====>........................] - ETA: 12s - loss: 0.3766 - acc: 0.9149
 5120/23646 [=====>........................] - ETA: 12s - loss: 0.3727 - acc: 0.9160
 5248/23646 [=====>........................] - ETA: 12s - loss: 0.3700 - acc: 0.9167
 5376/23646 [=====>........................] - ETA: 12s - loss: 0.3666 - acc: 0.9180
 5504/23646 [=====>........................] - ETA: 12s - loss: 0.3646 - acc: 0.9184
 5632/23646 [======>.......................] - ETA: 11s - loss: 0.3660 - acc: 0.9183
 5760/23646 [======>.......................] - ETA: 11s - loss: 0.3696 - acc: 0.9168
 5888/23646 [======>.......................] - ETA: 11s - loss: 0.3714 - acc: 0.9166
 6016/23646 [======>.......................] - ETA: 11s - loss: 0.3695 - acc: 0.9169
 6144/23646 [======>.......................] - ETA: 11s - loss: 0.3708 - acc: 0.9160
 6272/23646 [======>.......................] - ETA: 11s - loss: 0.3717 - acc: 0.9157
 6400/23646 [=======>......................] - ETA: 11s - loss: 0.3735 - acc: 0.9153
 6528/23646 [=======>......................] - ETA: 11s - loss: 0.3755 - acc: 0.9145
 6656/23646 [=======>......................] - ETA: 11s - loss: 0.3763 - acc: 0.9144
 6784/23646 [=======>......................] - ETA: 11s - loss: 0.3739 - acc: 0.9154
 6912/23646 [=======>......................] - ETA: 11s - loss: 0.3728 - acc: 0.9155
 7040/23646 [=======>......................] - ETA: 11s - loss: 0.3724 - acc: 0.9155
 7168/23646 [========>.....................] - ETA: 10s - loss: 0.3728 - acc: 0.9153
 7296/23646 [========>.....................] - ETA: 10s - loss: 0.3716 - acc: 0.9154
 7424/23646 [========>.....................] - ETA: 10s - loss: 0.3702 - acc: 0.9157
 7552/23646 [========>.....................] - ETA: 10s - loss: 0.3690 - acc: 0.9160
 7680/23646 [========>.....................] - ETA: 10s - loss: 0.3701 - acc: 0.9156
 7808/23646 [========>.....................] - ETA: 10s - loss: 0.3709 - acc: 0.9155
 7936/23646 [=========>....................] - ETA: 10s - loss: 0.3713 - acc: 0.9147
 8064/23646 [=========>....................] - ETA: 10s - loss: 0.3710 - acc: 0.9146
 8192/23646 [=========>....................] - ETA: 10s - loss: 0.3718 - acc: 0.9146
 8320/23646 [=========>....................] - ETA: 10s - loss: 0.3708 - acc: 0.9148
 8448/23646 [=========>....................] - ETA: 10s - loss: 0.3693 - acc: 0.9150
 8576/23646 [=========>....................] - ETA: 10s - loss: 0.3701 - acc: 0.9150
 8704/23646 [==========>...................] - ETA: 9s - loss: 0.3693 - acc: 0.9154 
 8832/23646 [==========>...................] - ETA: 9s - loss: 0.3697 - acc: 0.9152
 8960/23646 [==========>...................] - ETA: 9s - loss: 0.3696 - acc: 0.9152
 9088/23646 [==========>...................] - ETA: 9s - loss: 0.3705 - acc: 0.9152
 9216/23646 [==========>...................] - ETA: 9s - loss: 0.3688 - acc: 0.9159
 9344/23646 [==========>...................] - ETA: 9s - loss: 0.3696 - acc: 0.9157
 9472/23646 [===========>..................] - ETA: 9s - loss: 0.3716 - acc: 0.9152
 9600/23646 [===========>..................] - ETA: 9s - loss: 0.3720 - acc: 0.9153
 9728/23646 [===========>..................] - ETA: 9s - loss: 0.3714 - acc: 0.9153
 9856/23646 [===========>..................] - ETA: 9s - loss: 0.3720 - acc: 0.9154
 9984/23646 [===========>..................] - ETA: 9s - loss: 0.3719 - acc: 0.9154
10112/23646 [===========>..................] - ETA: 9s - loss: 0.3718 - acc: 0.9153
10240/23646 [===========>..................] - ETA: 8s - loss: 0.3718 - acc: 0.9153
10368/23646 [============>.................] - ETA: 8s - loss: 0.3716 - acc: 0.9151
10496/23646 [============>.................] - ETA: 8s - loss: 0.3726 - acc: 0.9149
10624/23646 [============>.................] - ETA: 8s - loss: 0.3717 - acc: 0.9152
10752/23646 [============>.................] - ETA: 8s - loss: 0.3712 - acc: 0.9153
10880/23646 [============>.................] - ETA: 8s - loss: 0.3712 - acc: 0.9153
11008/23646 [============>.................] - ETA: 8s - loss: 0.3708 - acc: 0.9154
11136/23646 [=============>................] - ETA: 8s - loss: 0.3714 - acc: 0.9153
11264/23646 [=============>................] - ETA: 8s - loss: 0.3711 - acc: 0.9153
11392/23646 [=============>................] - ETA: 8s - loss: 0.3717 - acc: 0.9151
11520/23646 [=============>................] - ETA: 8s - loss: 0.3716 - acc: 0.9152
11648/23646 [=============>................] - ETA: 8s - loss: 0.3714 - acc: 0.9152
11776/23646 [=============>................] - ETA: 7s - loss: 0.3711 - acc: 0.9152
11904/23646 [==============>...............] - ETA: 7s - loss: 0.3710 - acc: 0.9152
12032/23646 [==============>...............] - ETA: 7s - loss: 0.3704 - acc: 0.9156
12160/23646 [==============>...............] - ETA: 7s - loss: 0.3709 - acc: 0.9154
12288/23646 [==============>...............] - ETA: 7s - loss: 0.3714 - acc: 0.9152
12416/23646 [==============>...............] - ETA: 7s - loss: 0.3725 - acc: 0.9147
12544/23646 [==============>...............] - ETA: 7s - loss: 0.3718 - acc: 0.9149
12672/23646 [===============>..............] - ETA: 7s - loss: 0.3715 - acc: 0.9150
12800/23646 [===============>..............] - ETA: 7s - loss: 0.3730 - acc: 0.9145
12928/23646 [===============>..............] - ETA: 7s - loss: 0.3735 - acc: 0.9144
13056/23646 [===============>..............] - ETA: 7s - loss: 0.3727 - acc: 0.9149
13184/23646 [===============>..............] - ETA: 6s - loss: 0.3718 - acc: 0.9149
13312/23646 [===============>..............] - ETA: 6s - loss: 0.3706 - acc: 0.9154
13440/23646 [================>.............] - ETA: 6s - loss: 0.3704 - acc: 0.9154
13568/23646 [================>.............] - ETA: 6s - loss: 0.3692 - acc: 0.9158
13696/23646 [================>.............] - ETA: 6s - loss: 0.3696 - acc: 0.9157
13824/23646 [================>.............] - ETA: 6s - loss: 0.3696 - acc: 0.9156
13952/23646 [================>.............] - ETA: 6s - loss: 0.3694 - acc: 0.9154
14080/23646 [================>.............] - ETA: 6s - loss: 0.3697 - acc: 0.9153
14208/23646 [=================>............] - ETA: 6s - loss: 0.3694 - acc: 0.9154
14336/23646 [=================>............] - ETA: 6s - loss: 0.3702 - acc: 0.9149
14464/23646 [=================>............] - ETA: 6s - loss: 0.3715 - acc: 0.9141
14592/23646 [=================>............] - ETA: 6s - loss: 0.3726 - acc: 0.9137
14720/23646 [=================>............] - ETA: 5s - loss: 0.3726 - acc: 0.9137
14848/23646 [=================>............] - ETA: 5s - loss: 0.3731 - acc: 0.9135
14976/23646 [==================>...........] - ETA: 5s - loss: 0.3738 - acc: 0.9134
15104/23646 [==================>...........] - ETA: 5s - loss: 0.3734 - acc: 0.9136
15232/23646 [==================>...........] - ETA: 5s - loss: 0.3744 - acc: 0.9133
15360/23646 [==================>...........] - ETA: 5s - loss: 0.3736 - acc: 0.9133
15488/23646 [==================>...........] - ETA: 5s - loss: 0.3740 - acc: 0.9132
15616/23646 [==================>...........] - ETA: 5s - loss: 0.3738 - acc: 0.9135
15744/23646 [==================>...........] - ETA: 5s - loss: 0.3728 - acc: 0.9139
15872/23646 [===================>..........] - ETA: 5s - loss: 0.3736 - acc: 0.9136
16000/23646 [===================>..........] - ETA: 5s - loss: 0.3732 - acc: 0.9136
16128/23646 [===================>..........] - ETA: 5s - loss: 0.3731 - acc: 0.9136
16256/23646 [===================>..........] - ETA: 4s - loss: 0.3732 - acc: 0.9137
16384/23646 [===================>..........] - ETA: 4s - loss: 0.3747 - acc: 0.9135
16512/23646 [===================>..........] - ETA: 4s - loss: 0.3737 - acc: 0.9139
16640/23646 [====================>.........] - ETA: 4s - loss: 0.3731 - acc: 0.9140
16768/23646 [====================>.........] - ETA: 4s - loss: 0.3739 - acc: 0.9138
16896/23646 [====================>.........] - ETA: 4s - loss: 0.3735 - acc: 0.9140
17024/23646 [====================>.........] - ETA: 4s - loss: 0.3732 - acc: 0.9142
17152/23646 [====================>.........] - ETA: 4s - loss: 0.3731 - acc: 0.9142
17280/23646 [====================>.........] - ETA: 4s - loss: 0.3727 - acc: 0.9143
17408/23646 [=====================>........] - ETA: 4s - loss: 0.3735 - acc: 0.9141
17536/23646 [=====================>........] - ETA: 4s - loss: 0.3732 - acc: 0.9139
17664/23646 [=====================>........] - ETA: 3s - loss: 0.3733 - acc: 0.9138
17792/23646 [=====================>........] - ETA: 3s - loss: 0.3734 - acc: 0.9137
17920/23646 [=====================>........] - ETA: 3s - loss: 0.3729 - acc: 0.9138
18048/23646 [=====================>........] - ETA: 3s - loss: 0.3729 - acc: 0.9139
18176/23646 [======================>.......] - ETA: 3s - loss: 0.3726 - acc: 0.9138
18304/23646 [======================>.......] - ETA: 3s - loss: 0.3726 - acc: 0.9140
18432/23646 [======================>.......] - ETA: 3s - loss: 0.3728 - acc: 0.9141
18560/23646 [======================>.......] - ETA: 3s - loss: 0.3724 - acc: 0.9141
18688/23646 [======================>.......] - ETA: 3s - loss: 0.3722 - acc: 0.9141
18816/23646 [======================>.......] - ETA: 3s - loss: 0.3725 - acc: 0.9141
18944/23646 [=======================>......] - ETA: 3s - loss: 0.3731 - acc: 0.9140
19072/23646 [=======================>......] - ETA: 3s - loss: 0.3737 - acc: 0.9137
19200/23646 [=======================>......] - ETA: 2s - loss: 0.3730 - acc: 0.9140
19328/23646 [=======================>......] - ETA: 2s - loss: 0.3729 - acc: 0.9141
19456/23646 [=======================>......] - ETA: 2s - loss: 0.3738 - acc: 0.9138
19584/23646 [=======================>......] - ETA: 2s - loss: 0.3737 - acc: 0.9139
19712/23646 [========================>.....] - ETA: 2s - loss: 0.3733 - acc: 0.9140
19840/23646 [========================>.....] - ETA: 2s - loss: 0.3740 - acc: 0.9138
19968/23646 [========================>.....] - ETA: 2s - loss: 0.3727 - acc: 0.9141
20096/23646 [========================>.....] - ETA: 2s - loss: 0.3738 - acc: 0.9137
20224/23646 [========================>.....] - ETA: 2s - loss: 0.3737 - acc: 0.9137
20352/23646 [========================>.....] - ETA: 2s - loss: 0.3742 - acc: 0.9136
20480/23646 [========================>.....] - ETA: 2s - loss: 0.3732 - acc: 0.9140
20608/23646 [=========================>....] - ETA: 2s - loss: 0.3725 - acc: 0.9142
20736/23646 [=========================>....] - ETA: 1s - loss: 0.3730 - acc: 0.9141
20864/23646 [=========================>....] - ETA: 1s - loss: 0.3724 - acc: 0.9143
20992/23646 [=========================>....] - ETA: 1s - loss: 0.3722 - acc: 0.9143
21120/23646 [=========================>....] - ETA: 1s - loss: 0.3721 - acc: 0.9143
21248/23646 [=========================>....] - ETA: 1s - loss: 0.3720 - acc: 0.9143
21376/23646 [==========================>...] - ETA: 1s - loss: 0.3718 - acc: 0.9143
21504/23646 [==========================>...] - ETA: 1s - loss: 0.3715 - acc: 0.9144
21632/23646 [==========================>...] - ETA: 1s - loss: 0.3720 - acc: 0.9142
21760/23646 [==========================>...] - ETA: 1s - loss: 0.3719 - acc: 0.9144
21888/23646 [==========================>...] - ETA: 1s - loss: 0.3717 - acc: 0.9146
22016/23646 [==========================>...] - ETA: 1s - loss: 0.3723 - acc: 0.9143
22144/23646 [===========================>..] - ETA: 1s - loss: 0.3725 - acc: 0.9144
22272/23646 [===========================>..] - ETA: 0s - loss: 0.3719 - acc: 0.9145
22400/23646 [===========================>..] - ETA: 0s - loss: 0.3717 - acc: 0.9145
22528/23646 [===========================>..] - ETA: 0s - loss: 0.3713 - acc: 0.9147
22656/23646 [===========================>..] - ETA: 0s - loss: 0.3714 - acc: 0.9147
22784/23646 [===========================>..] - ETA: 0s - loss: 0.3713 - acc: 0.9146
22912/23646 [============================>.] - ETA: 0s - loss: 0.3708 - acc: 0.9147
23040/23646 [============================>.] - ETA: 0s - loss: 0.3717 - acc: 0.9143
23168/23646 [============================>.] - ETA: 0s - loss: 0.3714 - acc: 0.9143
23296/23646 [============================>.] - ETA: 0s - loss: 0.3717 - acc: 0.9142
23424/23646 [============================>.] - ETA: 0s - loss: 0.3714 - acc: 0.9142
23552/23646 [============================>.] - ETA: 0s - loss: 0.3714 - acc: 0.9142
Epoch 00026: val_acc improved from 0.82104 to 0.82138, saving model to best_model.h5

23646/23646 [==============================] - 17s 723us/sample - loss: 0.3722 - acc: 0.9139 - val_loss: 0.7062 - val_acc: 0.8214
Epoch 27/30

  128/23646 [..............................] - ETA: 17s - loss: 0.1665 - acc: 0.9766
  256/23646 [..............................] - ETA: 16s - loss: 0.2528 - acc: 0.9531
  384/23646 [..............................] - ETA: 16s - loss: 0.2849 - acc: 0.9453
  512/23646 [..............................] - ETA: 16s - loss: 0.2891 - acc: 0.9453
  640/23646 [..............................] - ETA: 16s - loss: 0.3210 - acc: 0.9344
  768/23646 [..............................] - ETA: 15s - loss: 0.3243 - acc: 0.9336
  896/23646 [>.............................] - ETA: 15s - loss: 0.3473 - acc: 0.9263
 1024/23646 [>.............................] - ETA: 15s - loss: 0.3480 - acc: 0.9277
 1152/23646 [>.............................] - ETA: 15s - loss: 0.3532 - acc: 0.9262
 1280/23646 [>.............................] - ETA: 15s - loss: 0.3600 - acc: 0.9250
 1408/23646 [>.............................] - ETA: 15s - loss: 0.3451 - acc: 0.9290
 1536/23646 [>.............................] - ETA: 15s - loss: 0.3367 - acc: 0.9310
 1664/23646 [=>............................] - ETA: 14s - loss: 0.3421 - acc: 0.9303
 1792/23646 [=>............................] - ETA: 14s - loss: 0.3425 - acc: 0.9297
 1920/23646 [=>............................] - ETA: 14s - loss: 0.3495 - acc: 0.9276
 2048/23646 [=>............................] - ETA: 14s - loss: 0.3481 - acc: 0.9282
 2176/23646 [=>............................] - ETA: 14s - loss: 0.3542 - acc: 0.9274
 2304/23646 [=>............................] - ETA: 14s - loss: 0.3584 - acc: 0.9275
 2432/23646 [==>...........................] - ETA: 14s - loss: 0.3583 - acc: 0.9285
 2560/23646 [==>...........................] - ETA: 14s - loss: 0.3584 - acc: 0.9273
 2688/23646 [==>...........................] - ETA: 14s - loss: 0.3528 - acc: 0.9286
 2816/23646 [==>...........................] - ETA: 14s - loss: 0.3566 - acc: 0.9251
 2944/23646 [==>...........................] - ETA: 14s - loss: 0.3634 - acc: 0.9215
 3072/23646 [==>...........................] - ETA: 14s - loss: 0.3632 - acc: 0.9212
 3200/23646 [===>..........................] - ETA: 14s - loss: 0.3599 - acc: 0.9222
 3328/23646 [===>..........................] - ETA: 13s - loss: 0.3561 - acc: 0.9240
 3456/23646 [===>..........................] - ETA: 13s - loss: 0.3531 - acc: 0.9248
 3584/23646 [===>..........................] - ETA: 13s - loss: 0.3576 - acc: 0.9238
 3712/23646 [===>..........................] - ETA: 13s - loss: 0.3571 - acc: 0.9235
 3840/23646 [===>..........................] - ETA: 13s - loss: 0.3587 - acc: 0.9227
 3968/23646 [====>.........................] - ETA: 13s - loss: 0.3559 - acc: 0.9231
 4096/23646 [====>.........................] - ETA: 13s - loss: 0.3543 - acc: 0.9233
 4224/23646 [====>.........................] - ETA: 13s - loss: 0.3512 - acc: 0.9238
 4352/23646 [====>.........................] - ETA: 13s - loss: 0.3555 - acc: 0.9221
 4480/23646 [====>.........................] - ETA: 13s - loss: 0.3564 - acc: 0.9217
 4608/23646 [====>.........................] - ETA: 13s - loss: 0.3579 - acc: 0.9217
 4736/23646 [=====>........................] - ETA: 12s - loss: 0.3540 - acc: 0.9225
 4864/23646 [=====>........................] - ETA: 12s - loss: 0.3521 - acc: 0.9229
 4992/23646 [=====>........................] - ETA: 12s - loss: 0.3530 - acc: 0.9227
 5120/23646 [=====>........................] - ETA: 12s - loss: 0.3538 - acc: 0.9223
 5248/23646 [=====>........................] - ETA: 12s - loss: 0.3519 - acc: 0.9228
 5376/23646 [=====>........................] - ETA: 12s - loss: 0.3528 - acc: 0.9224
 5504/23646 [=====>........................] - ETA: 12s - loss: 0.3550 - acc: 0.9219
 5632/23646 [======>.......................] - ETA: 12s - loss: 0.3539 - acc: 0.9224
 5760/23646 [======>.......................] - ETA: 12s - loss: 0.3519 - acc: 0.9227
 5888/23646 [======>.......................] - ETA: 12s - loss: 0.3479 - acc: 0.9239
 6016/23646 [======>.......................] - ETA: 12s - loss: 0.3489 - acc: 0.9235
 6144/23646 [======>.......................] - ETA: 11s - loss: 0.3503 - acc: 0.9227
 6272/23646 [======>.......................] - ETA: 11s - loss: 0.3537 - acc: 0.9224
 6400/23646 [=======>......................] - ETA: 11s - loss: 0.3545 - acc: 0.9225
 6528/23646 [=======>......................] - ETA: 11s - loss: 0.3549 - acc: 0.9220
 6656/23646 [=======>......................] - ETA: 11s - loss: 0.3549 - acc: 0.9220
 6784/23646 [=======>......................] - ETA: 11s - loss: 0.3536 - acc: 0.9220
 6912/23646 [=======>......................] - ETA: 11s - loss: 0.3527 - acc: 0.9226
 7040/23646 [=======>......................] - ETA: 11s - loss: 0.3522 - acc: 0.9227
 7168/23646 [========>.....................] - ETA: 11s - loss: 0.3529 - acc: 0.9220
 7296/23646 [========>.....................] - ETA: 11s - loss: 0.3556 - acc: 0.9213
 7424/23646 [========>.....................] - ETA: 11s - loss: 0.3553 - acc: 0.9213
 7552/23646 [========>.....................] - ETA: 10s - loss: 0.3556 - acc: 0.9209
 7680/23646 [========>.....................] - ETA: 10s - loss: 0.3546 - acc: 0.9214
 7808/23646 [========>.....................] - ETA: 10s - loss: 0.3555 - acc: 0.9207
 7936/23646 [=========>....................] - ETA: 10s - loss: 0.3540 - acc: 0.9214
 8064/23646 [=========>....................] - ETA: 10s - loss: 0.3548 - acc: 0.9209
 8192/23646 [=========>....................] - ETA: 10s - loss: 0.3555 - acc: 0.9207
 8320/23646 [=========>....................] - ETA: 10s - loss: 0.3541 - acc: 0.9209
 8448/23646 [=========>....................] - ETA: 10s - loss: 0.3541 - acc: 0.9208
 8576/23646 [=========>....................] - ETA: 10s - loss: 0.3543 - acc: 0.9206
 8704/23646 [==========>...................] - ETA: 10s - loss: 0.3560 - acc: 0.9199
 8832/23646 [==========>...................] - ETA: 10s - loss: 0.3578 - acc: 0.9193
 8960/23646 [==========>...................] - ETA: 9s - loss: 0.3601 - acc: 0.9191 
 9088/23646 [==========>...................] - ETA: 9s - loss: 0.3597 - acc: 0.9193
 9216/23646 [==========>...................] - ETA: 9s - loss: 0.3587 - acc: 0.9197
 9344/23646 [==========>...................] - ETA: 9s - loss: 0.3588 - acc: 0.9198
 9472/23646 [===========>..................] - ETA: 9s - loss: 0.3570 - acc: 0.9203
 9600/23646 [===========>..................] - ETA: 9s - loss: 0.3581 - acc: 0.9197
 9728/23646 [===========>..................] - ETA: 9s - loss: 0.3586 - acc: 0.9193
 9856/23646 [===========>..................] - ETA: 9s - loss: 0.3588 - acc: 0.9190
 9984/23646 [===========>..................] - ETA: 9s - loss: 0.3599 - acc: 0.9187
10112/23646 [===========>..................] - ETA: 9s - loss: 0.3601 - acc: 0.9186
10240/23646 [===========>..................] - ETA: 9s - loss: 0.3598 - acc: 0.9188
10368/23646 [============>.................] - ETA: 8s - loss: 0.3599 - acc: 0.9189
10496/23646 [============>.................] - ETA: 8s - loss: 0.3597 - acc: 0.9190
10624/23646 [============>.................] - ETA: 8s - loss: 0.3606 - acc: 0.9185
10752/23646 [============>.................] - ETA: 8s - loss: 0.3613 - acc: 0.9182
10880/23646 [============>.................] - ETA: 8s - loss: 0.3607 - acc: 0.9185
11008/23646 [============>.................] - ETA: 8s - loss: 0.3598 - acc: 0.9187
11136/23646 [=============>................] - ETA: 8s - loss: 0.3606 - acc: 0.9183
11264/23646 [=============>................] - ETA: 8s - loss: 0.3627 - acc: 0.9177
11392/23646 [=============>................] - ETA: 8s - loss: 0.3641 - acc: 0.9176
11520/23646 [=============>................] - ETA: 8s - loss: 0.3637 - acc: 0.9175
11648/23646 [=============>................] - ETA: 8s - loss: 0.3643 - acc: 0.9172
11776/23646 [=============>................] - ETA: 8s - loss: 0.3641 - acc: 0.9172
11904/23646 [==============>...............] - ETA: 7s - loss: 0.3642 - acc: 0.9171
12032/23646 [==============>...............] - ETA: 7s - loss: 0.3650 - acc: 0.9168
12160/23646 [==============>...............] - ETA: 7s - loss: 0.3654 - acc: 0.9160
12288/23646 [==============>...............] - ETA: 7s - loss: 0.3650 - acc: 0.9162
12416/23646 [==============>...............] - ETA: 7s - loss: 0.3641 - acc: 0.9164
12544/23646 [==============>...............] - ETA: 7s - loss: 0.3645 - acc: 0.9165
12672/23646 [===============>..............] - ETA: 7s - loss: 0.3641 - acc: 0.9167
12800/23646 [===============>..............] - ETA: 7s - loss: 0.3637 - acc: 0.9166
12928/23646 [===============>..............] - ETA: 7s - loss: 0.3635 - acc: 0.9167
13056/23646 [===============>..............] - ETA: 7s - loss: 0.3646 - acc: 0.9163
13184/23646 [===============>..............] - ETA: 7s - loss: 0.3654 - acc: 0.9160
13312/23646 [===============>..............] - ETA: 7s - loss: 0.3665 - acc: 0.9157
13440/23646 [================>.............] - ETA: 6s - loss: 0.3668 - acc: 0.9157
13568/23646 [================>.............] - ETA: 6s - loss: 0.3665 - acc: 0.9158
13696/23646 [================>.............] - ETA: 6s - loss: 0.3662 - acc: 0.9158
13824/23646 [================>.............] - ETA: 6s - loss: 0.3670 - acc: 0.9156
13952/23646 [================>.............] - ETA: 6s - loss: 0.3667 - acc: 0.9157
14080/23646 [================>.............] - ETA: 6s - loss: 0.3656 - acc: 0.9161
14208/23646 [=================>............] - ETA: 6s - loss: 0.3648 - acc: 0.9164
14336/23646 [=================>............] - ETA: 6s - loss: 0.3644 - acc: 0.9164
14464/23646 [=================>............] - ETA: 6s - loss: 0.3638 - acc: 0.9168
14592/23646 [=================>............] - ETA: 6s - loss: 0.3631 - acc: 0.9169
14720/23646 [=================>............] - ETA: 6s - loss: 0.3636 - acc: 0.9168
14848/23646 [=================>............] - ETA: 5s - loss: 0.3638 - acc: 0.9166
14976/23646 [==================>...........] - ETA: 5s - loss: 0.3640 - acc: 0.9164
15104/23646 [==================>...........] - ETA: 5s - loss: 0.3644 - acc: 0.9161
15232/23646 [==================>...........] - ETA: 5s - loss: 0.3640 - acc: 0.9161
15360/23646 [==================>...........] - ETA: 5s - loss: 0.3649 - acc: 0.9161
15488/23646 [==================>...........] - ETA: 5s - loss: 0.3644 - acc: 0.9162
15616/23646 [==================>...........] - ETA: 5s - loss: 0.3643 - acc: 0.9162
15744/23646 [==================>...........] - ETA: 5s - loss: 0.3635 - acc: 0.9164
15872/23646 [===================>..........] - ETA: 5s - loss: 0.3629 - acc: 0.9165
16000/23646 [===================>..........] - ETA: 5s - loss: 0.3632 - acc: 0.9165
16128/23646 [===================>..........] - ETA: 5s - loss: 0.3628 - acc: 0.9165
16256/23646 [===================>..........] - ETA: 5s - loss: 0.3628 - acc: 0.9164
16384/23646 [===================>..........] - ETA: 4s - loss: 0.3631 - acc: 0.9163
16512/23646 [===================>..........] - ETA: 4s - loss: 0.3624 - acc: 0.9165
16640/23646 [====================>.........] - ETA: 4s - loss: 0.3625 - acc: 0.9165
16768/23646 [====================>.........] - ETA: 4s - loss: 0.3619 - acc: 0.9167
16896/23646 [====================>.........] - ETA: 4s - loss: 0.3620 - acc: 0.9165
17024/23646 [====================>.........] - ETA: 4s - loss: 0.3625 - acc: 0.9162
17152/23646 [====================>.........] - ETA: 4s - loss: 0.3609 - acc: 0.9166
17280/23646 [====================>.........] - ETA: 4s - loss: 0.3610 - acc: 0.9164
17408/23646 [=====================>........] - ETA: 4s - loss: 0.3614 - acc: 0.9162
17536/23646 [=====================>........] - ETA: 4s - loss: 0.3611 - acc: 0.9163
17664/23646 [=====================>........] - ETA: 4s - loss: 0.3609 - acc: 0.9164
17792/23646 [=====================>........] - ETA: 3s - loss: 0.3609 - acc: 0.9166
17920/23646 [=====================>........] - ETA: 3s - loss: 0.3607 - acc: 0.9166
18048/23646 [=====================>........] - ETA: 3s - loss: 0.3599 - acc: 0.9168
18176/23646 [======================>.......] - ETA: 3s - loss: 0.3591 - acc: 0.9171
18304/23646 [======================>.......] - ETA: 3s - loss: 0.3589 - acc: 0.9171
18432/23646 [======================>.......] - ETA: 3s - loss: 0.3582 - acc: 0.9173
18560/23646 [======================>.......] - ETA: 3s - loss: 0.3580 - acc: 0.9174
18688/23646 [======================>.......] - ETA: 3s - loss: 0.3577 - acc: 0.9175
18816/23646 [======================>.......] - ETA: 3s - loss: 0.3577 - acc: 0.9175
18944/23646 [=======================>......] - ETA: 3s - loss: 0.3578 - acc: 0.9172
19072/23646 [=======================>......] - ETA: 3s - loss: 0.3580 - acc: 0.9172
19200/23646 [=======================>......] - ETA: 3s - loss: 0.3575 - acc: 0.9172
19328/23646 [=======================>......] - ETA: 2s - loss: 0.3571 - acc: 0.9173
19456/23646 [=======================>......] - ETA: 2s - loss: 0.3570 - acc: 0.9175
19584/23646 [=======================>......] - ETA: 2s - loss: 0.3568 - acc: 0.9176
19712/23646 [========================>.....] - ETA: 2s - loss: 0.3573 - acc: 0.9174
19840/23646 [========================>.....] - ETA: 2s - loss: 0.3574 - acc: 0.9173
19968/23646 [========================>.....] - ETA: 2s - loss: 0.3569 - acc: 0.9174
20096/23646 [========================>.....] - ETA: 2s - loss: 0.3569 - acc: 0.9174
20224/23646 [========================>.....] - ETA: 2s - loss: 0.3566 - acc: 0.9174
20352/23646 [========================>.....] - ETA: 2s - loss: 0.3571 - acc: 0.9173
20480/23646 [========================>.....] - ETA: 2s - loss: 0.3575 - acc: 0.9172
20608/23646 [=========================>....] - ETA: 2s - loss: 0.3566 - acc: 0.9174
20736/23646 [=========================>....] - ETA: 1s - loss: 0.3563 - acc: 0.9174
20864/23646 [=========================>....] - ETA: 1s - loss: 0.3562 - acc: 0.9174
20992/23646 [=========================>....] - ETA: 1s - loss: 0.3560 - acc: 0.9173
21120/23646 [=========================>....] - ETA: 1s - loss: 0.3561 - acc: 0.9172
21248/23646 [=========================>....] - ETA: 1s - loss: 0.3559 - acc: 0.9173
21376/23646 [==========================>...] - ETA: 1s - loss: 0.3559 - acc: 0.9172
21504/23646 [==========================>...] - ETA: 1s - loss: 0.3563 - acc: 0.9172
21632/23646 [==========================>...] - ETA: 1s - loss: 0.3568 - acc: 0.9171
21760/23646 [==========================>...] - ETA: 1s - loss: 0.3561 - acc: 0.9173
21888/23646 [==========================>...] - ETA: 1s - loss: 0.3557 - acc: 0.9174
22016/23646 [==========================>...] - ETA: 1s - loss: 0.3558 - acc: 0.9172
22144/23646 [===========================>..] - ETA: 1s - loss: 0.3558 - acc: 0.9173
22272/23646 [===========================>..] - ETA: 0s - loss: 0.3553 - acc: 0.9175
22400/23646 [===========================>..] - ETA: 0s - loss: 0.3553 - acc: 0.9174
22528/23646 [===========================>..] - ETA: 0s - loss: 0.3553 - acc: 0.9173
22656/23646 [===========================>..] - ETA: 0s - loss: 0.3564 - acc: 0.9170
22784/23646 [===========================>..] - ETA: 0s - loss: 0.3563 - acc: 0.9171
22912/23646 [============================>.] - ETA: 0s - loss: 0.3562 - acc: 0.9171
23040/23646 [============================>.] - ETA: 0s - loss: 0.3559 - acc: 0.9172
23168/23646 [============================>.] - ETA: 0s - loss: 0.3569 - acc: 0.9170
23296/23646 [============================>.] - ETA: 0s - loss: 0.3571 - acc: 0.9171
23424/23646 [============================>.] - ETA: 0s - loss: 0.3568 - acc: 0.9171
23552/23646 [============================>.] - ETA: 0s - loss: 0.3568 - acc: 0.9169
Epoch 00027: val_acc improved from 0.82138 to 0.82696, saving model to best_model.h5

23646/23646 [==============================] - 17s 736us/sample - loss: 0.3568 - acc: 0.9169 - val_loss: 0.6969 - val_acc: 0.8270